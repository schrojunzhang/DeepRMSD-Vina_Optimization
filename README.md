# DeepRMSD+Vina
This algorithm is based on deep learning and a classical scoring function (Vina score) and is designed to optimize ligand conformations. 

<img src="models/figure1.png">

## Install 

    conda install -c conda-forge spyrmsd
    conda install pytorch
    conda install numpy pandas

## Contact
Liangzhen Zheng, Shanghai Zelixir Biotech Company Ltd, astrozheng@gmail.com</p>
Zechen Wang, Shandong University, wangzch97@163.com</p>

## Usage 
### 1. Prepare structural files for proteins and ligands.
The algorithm simultaneously optimizes multiple poses of a ligand, which must be generated by the same docking program and placed in the same directory in PDBQT format. The PDBQT files for proteins and ligands can be generated by MGLTools. The detailed process is as follows.

    pythonsh prepare_receptor4.py -r protein.pdb -U lps -o protein.pdbqt
    pythonsh prepare_ligand4.py -l ligand.mol2 -U lps -o ligand.pdbqt 

### 2. Prepare the input file with a pdb code, a protein PDBQT file and the directory where the ligand poses (PDBQT file) are located written on each line, separated by a space.
The content of the input file is as follows
    
    1gpn ./samples/1gpn/1gpn_protein_atom_noHETATM.pdbqt samples/1gpn/decoys
    1syi ./samples/1syi/1syi_protein_atom_noHETATM.pdbqt samples/1syi/decoys
    
### 3. Run the optimization framework with default parameters included in scripts.

    bash run_pose_optimization.sh inputs.dat

Finally, the program outputs the optimized ligand conformation ("final_optimized_cnfr.pdb") and the final score. In addition, the conformation changes and scores during optimization are recorded in the "optimized_traj.pdb" and "opt_data.csv" files, respectively.
